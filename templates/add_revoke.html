{% extends 'base.html' %}

{% block title %}
  Request
{% endblock title %}

{% block button %}
<ul class="navbar-nav" style="margin-left:auto;">
  <li class="nav-item">
    <form action="{{ url_for('signout') }}" method="post">
      <button type="submit" class="btn btn-outline-danger">Sign Out</button>
    </form>
  </li>
</ul>
{% endblock button %}

{% block content %}
<h2>Manage Download Requests</h2>

{% if requests|length == 0 %}
  <div class="alert alert-secondary" role="alert">
    No Download Requests Found!
  </div>
{% else %}
  <table class="table table-striped">
    <thead class="thead-dark">
      <tr>
        <th scope="col">sr.no</th>
        <th scope="col">User</th>
        <th scope="col">Book</th>
        <th scope="col">Status</th>
        <th scope="col">Action</th>
      </tr>
    </thead>
    <tbody>
      {% for r in requests %}
      <tr>
        <th scope="row">{{ loop.index }}</th>
        <td>{{ r.user.name }}</td>
        <td>{{ r.book.b_name }}</td>
        <td class="text-capitalize">{{ r.status }}</td>
        <td>
            <form action="{{ url_for('approve_request', request_id=r.id) }}" method="POST" style="display:inline;">
              <button type="submit" class="btn btn-success btn-sm" onclick="return confirm('Approve this request?')">Approve</button>
            </form>
            <form action="{{ url_for('reject_request', request_id=r.id) }}" method="POST" style="display:inline;">
              <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Reject this request?')">Reject</button>
            </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
{% endif %}
{% endblock content %}
